#if ($jqlValidationResult.isOAuthNeeded())
    #if (!$isPreviewMode)
        <span class="oauth-msg">
            <a class="static-oauth-init" href="$jqlValidationResult.getAuthUrl()">$action.getText('jiraissues.oauth.linktext')</a>
            $action.getText('jiraissues.oauth.single.message')
        </span>
    #end
#end
#if ($jqlValidationResult.isValidJQL())
    #if($isPreviewMode)
        <div class="jira-chart-macro-preview-container">
    #end

    #if($pdfExport)
        <style type="text/css">
            .jira-chart-macro-wrapper {
                display: inline-block;
                padding: 1px;
            }

            .jirachart-border {
                border: 1px solid #CCCCCC;
            }

            .jira-chart-macro-wrapper .jira-chart-macro-img {
                display: block;
            }

            .info {
                text-align: center;
                padding-bottom: 5px;
            }
        </style>
    #end

    <div class="jira-chart-macro-wrapper #if($showBorder) jirachart-border #end">
        <img class="jira-chart-macro-img" src="$srcImg"/>
        #if ($showInfor)
            <div class="info">
                <a href="$jqlValidationResult.FilterUrl" target="_blank">
                    $action.getText('jirachart.macro.showinfor.total')
                    $jqlValidationResult.IssueCount
                </a>
                <span>$action.getText('jirachart.macro.showinfor.statistictype', [$statType])</span>
            </div>
        #end
    </div>

    #if($isPreviewMode)
        </div>
    #end
#else
    <div class="jira-chart-macro-preview-container">
        $soyTemplateRendererHelper.getRenderedTemplateHtml('confluence.extra.jira:dialogsJs',
        'Confluence.Templates.ConfluenceJiraPlugin.jqlInvalid.soy',{})
    </div>
#end
